# U-WhatToEat - 今日吃什么

一款智能餐饮推荐应用，通过随机推荐帮助用户解决"今天吃什么"的选择困难症。支持菜系筛选、评分筛选、菜品管理、历史记录和评价反馈等功能。

## 声明

本项目由阿里云ESA提供加速、计算和保护
![阿里云ESA](aliyun.png)

## 功能特性

- **智能随机推荐**
  - 持续滚动式随机选择，点击停止后确定菜品
  - 支持菜系筛选（中餐、西餐、日韩料理、快餐、素食）
  - 支持最低评分筛选（0-5星）
  - 已选菜品自动从推荐池移除，避免重复推荐
  - 实时显示剩余可选菜品数量

- **菜品管理**
  - 添加自定义菜品，设置名称、分类和评分
  - 编辑现有菜品信息
  - 删除不需要的菜品
  - 按分类查看和搜索菜品

- **历史记录**
  - 自动保存每次推荐的菜品
  - 按分类筛选历史记录
  - 按日期或评分排序
  - 查看每次推荐的评价反馈
  - 删除单条历史记录

- **评价反馈**
  - 对推荐菜品进行1-5星评分
  - 添加文字评价（可选）
  - 提交评价后自动保存到历史记录

- **数据持久化**
  - 使用 LocalStorage 自动保存所有数据
  - 刷新页面不丢失数据
  - 支持加载示例数据或清空重置

## 技术栈

- **前端框架**: React 18.2.0
- **构建工具**: Vite 5.1.0
- **UI样式**: Tailwind CSS 3.4.14
- **图标库**: Lucide React 0.344.0
- **日期处理**: date-fns 3.3.1
- **路由**: React Router DOM 6.22.0
- **状态管理**: React Hooks (useState, useEffect, useRef)
- **数据存储**: LocalStorage

## 快速开始

### 安装依赖

```bash
cd U-WhatToEat
npm install
```

### 启动开发服务器

```bash
npm run dev
```

访问 http://localhost:5173 查看应用

### 构建生产版本

```bash
npm run build
```

构建产物位于 `dist` 目录

### 预览生产构建

```bash
npm run preview
```

## 使用说明

### 1. 初始化数据

- **加载示例数据**：点击左侧菜单的"加载示例数据"按钮，加载预设的菜品库（包含30道不同分类的菜品和4条历史记录）
- **清空重置**：点击"清空重置"按钮，清空所有数据，从零开始创建自己的菜品库

### 2. 随机推荐

1. **设置筛选条件**（可选）
   - 选择菜系：全部 / 中餐 / 西餐 / 日韩料理 / 快餐 / 素食
   - 选择最低评分：不限 / 1星及以上 / 2星及以上 / 3星及以上 / 4星及以上 / 5星
   - 点击"清除筛选"快速重置所有筛选条件

2. **开始随机**
   - 点击"随机推荐"按钮，菜品开始滚动显示
   - 点击"停止随机"按钮，停止滚动并确定推荐菜品
   - 推荐的菜品会自动从推荐池移除，不会重复推荐

3. **查看结果**
   - 显示菜品的名称、分类标签和评分（星级显示）
   - 显示"已从推荐池移除"提示
   - 显示剩余可选菜品数量

4. **重置推荐池**
   - 点击重置按钮（旋转图标），清空已选菜品列表，所有菜品重新加入推荐池

### 3. 菜品管理

在"菜品管理"页面可以：

- **添加菜品**：
  1. 输入菜品名称
  2. 选择分类（中餐、西餐、日韩料理、快餐、素食）
  3. 设置评分（1-5星）
  4. 点击"添加菜品"按钮

- **编辑菜品**：
  1. 找到要编辑的菜品
  2. 点击编辑按钮（铅笔图标）
  3. 修改菜品信息
  4. 点击保存

- **删除菜品**：
  1. 找到要删除的菜品
  2. 点击删除按钮（垃圾桶图标）
  3. 确认删除

- **搜索菜品**：
  1. 在搜索框输入菜品名称
  2. 实时显示匹配结果

- **按分类查看**：
  1. 点击分类标签
  2. 只显示该分类的菜品

### 4. 历史记录

在"历史记录"页面可以：

- **查看历史**：查看所有已推荐菜品的历史记录
- **筛选记录**：按分类筛选（全部 / 中餐 / 西餐 / 日韩料理 / 快餐 / 素食）
- **排序记录**：按日期排序或按评分排序
- **查看详情**：
  - 菜品名称和分类标签
  - 评分（星级显示）
  - 推荐日期
  - 评价反馈内容
- **删除记录**：点击删除按钮移除单条历史记录

### 5. 评价反馈

在"评价反馈"页面可以：

1. **前提条件**：需要先在"随机推荐"页面选择一道菜品
2. **评价菜品**：
   - 点击星星进行评分（1-5星）
   - 输入文字评价反馈（可选）
   - 点击"提交评价"按钮
3. **查看提交状态**：提交成功后显示确认提示
4. **评价保存**：评价自动保存到历史记录中

## 菜品分类

应用预设以下5个分类：

- **中餐**：如宫保鸡丁、红烧肉、麻婆豆腐等
- **西餐**：如意大利面、牛排、披萨等
- **日韩料理**：如寿司、拉面、烤肉等
- **快餐**：如炸鸡、薯条、汉堡包等
- **素食**：如素炒青菜、豆腐汤、蔬菜沙拉等

## 数据存储

所有数据均保存在浏览器的 LocalStorage 中：

- `whatToEat_dishes`：菜品库数据
- `whatToEat_history`：历史记录数据

**注意**：
- 刷新页面不会丢失数据
- 清除浏览器缓存或 LocalStorage 会导致数据丢失
- 如需清除数据，可点击"清空重置"按钮

## 浏览器兼容性

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 部署说明

### 本地部署

1. 构建项目：
```bash
npm run build
```

2. 预览构建结果：
```bash
npm run preview
```

### 部署到静态托管服务

该应用为纯静态前端项目，可部署到任何支持静态网站托管的服务：

- **Vercel**：连接 Git 仓库，自动部署
- **Netlify**：拖放 dist 目录或连接 Git 仓库
- **GitHub Pages**：使用 gh-pages 部署
- **阿里云 ESA / OSS**：上传 dist 目录内容
- **其他 CDN**：上传 dist 目录内容

### 部署到阿里云 ESA

1. 构建项目：
```bash
npm run build
```

2. 将 `dist` 目录下的所有文件上传到阿里云 ESA 存储桶
3. 配置静态网站托管
4. 绑定自定义域名（可选）
5. 配置 HTTPS 和 CDN 加速

## 项目结构

```
U-WhatToEat/
├── src/
│   ├── components/          # React 组件
│   │   ├── RandomPicker.jsx    # 随机推荐器（支持菜系和评分筛选）
│   │   ├── DishManager.jsx     # 菜品管理器（增删改查）
│   │   ├── History.jsx         # 历史记录（筛选、排序）
│   │   └── Feedback.jsx        # 评价反馈组件
│   ├── data/               # 示例数据
│   │   └── sampleData.js       # 示例菜品和历史数据
│   ├── utils/              # 工具函数
│   │   └── storage.js         # LocalStorage 封装
│   ├── App.jsx             # 主应用组件（路由、状态管理）
│   ├── main.jsx            # 应用入口
│   └── index.css           # Tailwind CSS 样式
├── public/                # 静态资源
│   └── aliyun.png          # 网站图标
├── dist/                  # 构建产物（npm run build 生成）
├── node_modules/          # 依赖包（npm install 生成）
├── package.json           # 项目配置和依赖
├── vite.config.js         # Vite 配置
├── tailwind.config.js     # Tailwind CSS 配置
├── postcss.config.js      # PostCSS 配置
├── index.html             # HTML 入口文件
├── esa.jsonc              # ESA 部署配置
└── README.md              # 项目说明文档
```

## 核心功能实现

### 随机推荐算法

- 使用 `setInterval` 实现持续滚动效果
- 支持 `clearInterval` 手动停止滚动
- 筛选条件实时生效：`availableDishes.filter(dish => ...)`
- 使用 `useRef` 保存 interval 引用，避免组件重渲染导致的问题

### 状态管理

- 使用 React Hooks 管理组件状态
- 主要状态：菜品列表、历史记录、当前菜品、推荐池、筛选条件等
- 通过 props 传递状态和回调函数

### 数据持久化

- 封装 `storage` 工具模块，提供 get/set/remove 方法
- 使用 JSON 序列化/反序列化处理数据
- 在 useEffect 中监听数据变化，自动保存到 LocalStorage

## 常见问题

**Q: 推荐池中的菜品被选完后怎么办？**

A: 点击重置按钮（旋转图标），清空已选菜品列表，所有菜品重新加入推荐池。

**Q: 如何清空所有数据？**

A: 点击左侧菜单的"清空重置"按钮，会清空菜品库和历史记录。

**Q: 数据会丢失吗？**

A: 不会，所有数据保存在 LocalStorage 中，刷新页面不丢失。但清除浏览器缓存会丢失数据。

**Q: 可以自定义菜品分类吗？**

A: 当前版本支持5个固定分类，如需自定义分类，需要修改代码。

**Q: 支持多用户吗？**

A: 不支持，数据保存在浏览器本地，每个用户的数据独立。

## 更新日志

### v1.0.0 (2025-01-19)

- ✨ 初始版本发布
- 🎲 持续滚动式随机推荐功能
- 🔍 菜系和评分筛选功能
- 📝 菜品管理（增删改查）
- 📊 历史记录（筛选、排序）
- 💬 评价反馈功能
- 💾 LocalStorage 数据持久化
- 📱 响应式设计，支持移动端

## 许可证

本项目为开源项目，仅供学习和个人使用。

## 联系方式

如有问题或建议，欢迎提交 Issue。
